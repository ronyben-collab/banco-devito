<!-- BANCO RB - HTML COMPLETO
MISMO MODELO + MISMO FIREBASE
PRÃ‰STAMOS BANCO + PRÃ‰STAMOS ENTRE JUGADORES
SCORE + INTERESES + MENSAJES
---------------------------------- -->

<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="UTF-8">
<title>BancoRB</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
body{font-family:Arial;background:#111;color:#fff;padding:20px}
.card{background:#1e1e1e;padding:15px;margin:15px 0;border-radius:10px}
input,button{width:100%;padding:8px;margin:5px 0;border-radius:5px;border:none}
button{background:#00ff99;font-weight:bold}
.red{color:#ff4444}
.green{color:#00ff99}
</style>
</head>
<body>

<h1>ğŸ¦ BancoRB</h1>

<!-- LOGIN -->

<div class="card" id="loginBox">
<h3>Iniciar sesiÃ³n</h3>
<input id="email" placeholder="Correo">
<input id="pass" type="password" placeholder="ContraseÃ±a">
<button onclick="login()">Entrar</button>
<button onclick="register()">Registrarse</button>
</div>

<!-- PANEL -->

<div id="panel" style="display:none">
<div class="card">
<h3>Cuenta</h3>
<p>Saldo: <b id="saldo">0</b></p>
<p>Score: <b id="score">500</b></p>
<button onclick="logout()">Cerrar sesiÃ³n</button>
</div>

<!-- PRESTAMO BANCO -->

<div class="card">
<h3>ğŸ¦ PrÃ©stamo del banco</h3>
<input id="montoBanco" type="number" placeholder="Monto">
<button onclick="prestamoBanco()">Solicitar</button>
<div id="msgBanco"></div>
</div>

<!-- PRESTAMO JUGADOR -->

<div class="card">
<h3>ğŸ¤ Prestar a jugador</h3>
<input id="tarjetaJugador" placeholder="ID jugador">
<input id="montoJugador" type="number" placeholder="Monto">
<input id="diasJugador" type="number" placeholder="DÃ­as">
<label><input type="checkbox" id="interesJugador"> Cobrar interÃ©s</label>
<button onclick="prestamoJugador()">Prestar</button>
<div id="msgJugador"></div>
</div>

<!-- PRESTAMOS -->

<div class="card">
<h3>ğŸ“‘ PrÃ©stamos</h3>
<div id="listaPrestamos"></div>
</div>
</div>

<script>
// FIREBASE
const firebaseConfig={
  apiKey:"TU_API_KEY",
  authDomain:"TU_AUTH",
  databaseURL:"TU_DB_URL",
  projectId:"TU_PROJECT"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.database();
let uid="";

// AUTH
function login(){auth.signInWithEmailAndPassword(email.value,pass.value)}
function register(){auth.createUserWithEmailAndPassword(email.value,pass.value)}
function logout(){auth.signOut()}

// SESION
auth.onAuthStateChanged(u=>{
 if(u){uid=u.uid;loginBox.style.display='none';panel.style.display='block';cargar();}
 else{loginBox.style.display='block';panel.style.display='none'}
});

function cargar(){
 db.ref('users/'+uid).once('value').then(s=>{
  if(!s.exists()){
   db.ref('users/'+uid).set({saldo:1000,score:500})
  }
 })
 actualizar();
 cargarPrestamos();
}

function actualizar(){
 db.ref('users/'+uid).on('value',s=>{
  saldo.innerText=s.val().saldo;
  score.innerText=s.val().score;
 })
}

// PRESTAMO BANCO
function prestamoBanco(){
 const m=parseInt(montoBanco.value);
 msgBanco.innerText="";
 db.ref('users/'+uid).once('value').then(s=>{
  let u=s.val();
  if(u.score<400){msgBanco.innerHTML='<span class=red>Score muy bajo</span>';return}
  if(m>u.saldo*3){msgBanco.innerHTML='<span class=red>Monto no permitido</span>';return}
  const interes=m<=500?0.05:m<=1000?0.08:0.12;
  const total=Math.floor(m*(1+interes));
  db.ref('users/'+uid).update({saldo:u.saldo+m});
  db.ref('prestamos/'+uid).push({tipo:'banco',m,total,pagado:false});
  msgBanco.innerHTML='<span class=green>PrÃ©stamo concedido</span>';
 })
}

// PRESTAMO JUGADOR
function prestamoJugador(){
 const m=parseInt(montoJugador.value);
 const d=parseInt(diasJugador.value);
 if(!m||!d){msgJugador.innerText='Datos incompletos';return}
 const interes=interesJugador.checked?(m<=500?0.05:m<=1000?0.08:0.12):0;
 db.ref('prestamos/'+uid).push({tipo:'jugador',m,interes,total:Math.floor(m*(1+interes)),pagado:false});
 msgJugador.innerHTML='<span class=green>PrÃ©stamo realizado</span>';
}

function cargarPrestamos(){
 db.ref('prestamos/'+uid).on('value',s=>{
  listaPrestamos.innerHTML='';
  s.forEach(p=>{
   let e=p.val();
   listaPrestamos.innerHTML+=`<p>${e.tipo} - ${e.total} - ${e.pagado?'ğŸŸ¢ Pagado':'ğŸ”´ Activo'}</p>`;
  })
 })
}
</script>

</body>
</html>
